<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Using Machine Learning to Improve Coarse-Grained Simulations - 2020 MolSSI Software Fellow Posters</title>
<meta name="description" content="Introduction">


  <meta name="author" content="Heta A. Gandhi">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="2020 MolSSI Software Fellow Posters">
<meta property="og:title" content="Using Machine Learning to Improve Coarse-Grained Simulations">
<meta property="og:url" content="https://education.molssi.org/2020-software-fellow-posters/heta-gandhi/">


  <meta property="og:description" content="Introduction">







  <meta property="article:published_time" content="2020-06-16T00:00:00+00:00">





  

  


<link rel="canonical" href="https://education.molssi.org/2020-software-fellow-posters/heta-gandhi/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "The Molecular Sciences Software Institute",
      "url": "https://education.molssi.org/2020-software-fellow-posters/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/2020-software-fellow-posters/feed.xml" type="application/atom+xml" rel="alternate" title="2020 MolSSI Software Fellow Posters Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/2020-software-fellow-posters/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<link rel="stylesheet" href="https://use.typekit.net/wll4tkr.css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script src="https://unpkg.com/ngl@0.10.4/dist/ngl.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169902961-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169902961-1');
</script>


<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  <script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

  <body class="layout--poster">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/2020-software-fellow-posters/"><img src="/2020-software-fellow-posters/assets/images/avatars/molssi_avatar.png" alt=""></a>
        
        <a class="site-title" href="/2020-software-fellow-posters/">
          2020 MolSSI Software Fellow Posters
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/2020-software-fellow-posters/all_posters">Full Poster List</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/2020-software-fellow-posters/assets/images/avatars/heta_gandhi.JPG" alt="Heta A. Gandhi" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Heta A. Gandhi</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>PhD Student at University of Rochester, Software Investment Fellow at The Molecular Sciences Software Institute</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:hgandhi@ur.rochester.edu" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="http://thewhitelab.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/gandhi_heta" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/hgandhi2411" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/hetagandhi/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Using Machine Learning to Improve Coarse-Grained Simulations">
    <meta itemprop="description" content="Introduction">
    <meta itemprop="datePublished" content="2020-06-16T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Using Machine Learning to Improve Coarse-Grained Simulations
</h1>
          <div id="author-list" class="author__list">
            
              Heta A. Gandhi<sup>1</sup>,
            
              Rainier Barrett<sup>1</sup>,
            
              Maghesree Chakraborty<sup>1</sup>,
            
              Dilnoza Amirkulova<sup>1</sup>,
            
              Geemi Wellawatte<sup>1</sup>,
            
              Andrew D. White<sup>1</sup>
            
          </div>
    
          <div id="affiliation-list" class="affiliation__list">
            
              <div>
<strong>1</strong> Department of Chemical Engineering, University of Rochester, Rochester, NY</div>
            
          </div>
       
        </header>
      

      
            <div id="mentor-name" class="mentor__list">
              <strong>MolSSI Mentor(s):</strong> Jessica A. Nash
            </div>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Poster Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#coarse-grained-simulations">Coarse-Grained simulations</a></li>
  <li>
<a href="#htf-software">HTF Software</a>
    <ul>
      <li><a href="#using-all-atom-trajectories">Using All-Atom Trajectories</a></li>
      <li><a href="#force-matching">Force Matching</a></li>
    </ul>
  </li>
  <li><a href="#source-code">Source Code</a></li>
  <li><a href="#future-work">Future Work</a></li>
  <li><a href="#references">References</a></li>
  <li><a href="#acknowledgements">Acknowledgements</a></li>
</ul>

            </nav>
          </aside>
        
        <h2 id="introduction">Introduction</h2>

<p>Machine learning is a powerful and flexible toolset that can be used alongside molecular dynamics simulations to improve accuracy and learn underlying distributions and characteristics of a system of interest. Here we demonstrate the use of a new software method, HTF,<sup>1</sup> that connects the machine learning library TensorFlow with the molecular dynamics engine HOOMD-blue, with specific application to Coarse-Grained simulations.</p>

<h2 id="coarse-grained-simulations">Coarse-Grained simulations</h2>

<p>A coarse-grained (CG) molecular dynamics (MD) simulation is a reduced dimensional approximation to a normal all-atom (AA) MD simulation.<sup>2-4</sup> CG is a multiscale modeling technique which allows MD simulations at larger time-scales and length-scales.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/heta_gandhi/multiresolution.svg" alt="CG">
<em>Figure 1:</em> Illustration of different coarse-grained resolutions and how they are connected to different length-scale features.</p>

<p>There are two steps that specify a coarse-grained (CG) system:<br>
(i) Mapping operator: <strong>r → R</strong> <br>
(ii) Potential energy: U(<strong>R</strong>)</p>

<h2 id="htf-software">HTF Software</h2>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/heta_gandhi/htf.png" alt="HTF-schematic"></p>

<p>The HTF package gives TensorFlow<sup>5</sup> access to the per-particle positions, neighbor lists, and forces generated by HOOMD-blue<sup>6</sup> at each time step of a simulation. Hence, one can do learning on MD trajectories, propagate MD based on ML models, or both.</p>

<p>One of the challenges in CG simulations is the difficulty in accurately calculating CG potentials from AA simulation trajectories. Using HTF, one can process AA trajectories from popular simulation engines like GROMACS, learn the CG potential from this AA trajectory and run a CG simulation.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/heta_gandhi/schematic.png" alt="CG-schematic"></p>

<h3 id="using-all-atom-trajectories">Using All-Atom Trajectories</h3>

<p>The user needs to pass in a MDAnalysis<sup>7-8</sup> Universe object to process the trajectory and perform any tensor operations on it which are specified in a TensorFlow graph. A complete example can be found in <a href="https://github.com/ur-whitelab/hoomd-tf/blob/master/examples/07.%20Running%20From%20Trajectory.ipynb">this tutorial</a>.</p>

<h3 id="force-matching">Force Matching</h3>

<p>To learn the CG potential we used Force Matching (FM). FM<sup>x</sup> is a bottom-up CG approach which aims to match the forces on CG particles as closely as possible to the cumulative forces on their constituent atoms in the reference AA simulations.</p>

<p>The reference mapped force is given by</p>

\[\mathbf{F}^{ref}_{I}(\mathbf{r}) = \sum_{i\in S_I}\vec{F}_i(\mathbf{r})\]

<p><strong>r</strong>: coordinates of particles in an all-atom simulation<br>
<strong>R</strong>: corresponding coarse-grained particle positions</p>

<p>The FM method finds \(\mathbf{F}^{CG}(\mathbf{R})\) that minimizes the objective function</p>

\[\chi^2= \Bigg \langle \frac{1}{3N}\sum_{I=1}^{N}\left|\mathbf{F}^{CG}_{I}(\mathbf{R})-\mathbf{F}^{ref}_{I}(\mathbf{r})\right|^{2}\Bigg \rangle\]

<p>A 1 particle methanol system was used to learn the CG potential. The optimization was done at a learning rate of 0.1 using the ADAM optimizer<sup>37</sup> by minimizing the objective function</p>

<table>
  <tbody>
    <tr>
      <td><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/heta_gandhi/potential-aug22.jpg" alt="Potential"></td>
      <td><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/heta_gandhi/inf-rdf-aug22.jpg" alt="Potential"></td>
    </tr>
    <tr>
      <td>The learned CG potential along with the fit centers of Guassian Basis set functions for a 1 particle methanol system</td>
      <td>The center of mass radial distribution function from the mapped and CG trajectories.</td>
    </tr>
  </tbody>
</table>

<h2 id="source-code">Source Code</h2>

<p>Find the source code for HTF <a href="https://github.com/ur-whitelab/hoomd-tf">on github</a> and the documentation is available <a href="https://hoomd-tf.readthedocs.io/">here</a>.</p>

<h2 id="future-work">Future Work</h2>

<p>We are working on expanding the suite of methods to perform CG potential learning implementations in HTF. Another goal for this project is to implement a neural network CG force-field to be able to get a function form of the potential rather than a tabulated form.</p>

<h2 id="references">References</h2>

<ol>
  <li>
    <p>Barrett R, Chakraborty M, Amirkulova D, Gandhi HA, White AD (2019). A GPU-Accelerated Machine Learning Framework for Molecular Simulation: Hoomd-Blue with TensorFlow. <i>ChemRxiv</i>. doi: 10.26434/chemrxiv.8019527</p>
  </li>
  <li>
    <p>Hadley KR and McCabe C (2012). Coarse-Grained Molecular Models of Water: A Review. <i>Molecular simulation</i> 38:671-681.</p>
  </li>
  <li>
    <p>May A, Pool R, van Dijk E, Bijlard J, Abeln S, Heringa J, and Feenstra KA (2014). Coarse-grained versus atomistic simulations: realistic interaction free energies for real proteins. <i>Bioinformatics</i> 30:326-334.</p>
  </li>
  <li>
    <p>Morriss-Andrews A and Shea JE (2014). Simulations of Protein Aggregation: Insights from Atomistic and Coarse-Grained Models. <i>The Journal of Physical Chemistry Letters</i> 5:1899{1908.</p>
  </li>
  <li>
    <p>Abadi M, Agarwal A, Barham P, Brevdo E, Chen Z, Citro C, Corrado GS, Davis A, Dean J, Devin M, Ghemawat S, Goodfellow I, Harp A, Irving G, Isard M, Jia Y, Jozefowicz R, Kaiser L, Kudlur M, Levenberg J, Mané D, Monga R, Moore S, Murray D, Olah C, Schuster M, Shlens J, Steiner B, Sutskever I, Talwar K, Tucker P, Vanhoucke V, Vasudevan V, Viégas F, Vinyals O, Warden P, Wattenberg M, Wicke M, Yu Y, and Zheng X (2015). TensorFlow: Large-Scale Machine Learning on Heterogeneous Systems.</p>
  </li>
  <li>
    <p>Anderson JA, Glaser J, and Glotzer SC (2019). HOOMD-blue: A Python package for high-performance molecular dynamics and hard particle Monte Carlo simulations. 10.1016/j.commatsci.2019.109363, arXiv:1308.5587.</p>
  </li>
  <li>
    <p>Gowers RJ, Linke M, Barnoud J, Reddy TJE, Melo MN, Seyler SL, Dotson DL, Domanski J, Buchoux S, Kenney IM, Beckstein O (2016). MDAnalysis: A Python package for the rapid analysis of molecular dynamics simulations. In Benthall S and Rostrup S, editors, <i>Proceedings of the 15th Python in Science Conference</i>, 98-105, Austin, TX, 2016. SciPy, doi:10.25080/majora-629e541a-00e.</p>
  </li>
  <li>
    <p>Michaud-Agrawal N, Denning EJ, Woolf TB, and Beckstein O (2011). MDAnalysis: A Toolkit for the Analysis of Molecular Dynamics Simulations. <i>J. Comput. Chem.</i> 32, 2319-2327, doi:10.1002/jcc.21787. PMCID:PMC3144279</p>
  </li>
</ol>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>Heta A. Gandhi was supported by a fellowship from The Molecular Sciences Software Institute under NSF grant OAC-1547580. The authors thank the Center for Integrated Research Computing (CIRC) at the University of Rochester for providing computational resources and technical support. This work was also supported by the National Science Foundation (CBET-1751471 and CHE-1764415).</p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-06-16T00:00:00+00:00">June 16, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Using+Machine+Learning+to+Improve+Coarse-Grained+Simulations%20https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fheta-gandhi%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fheta-gandhi%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fheta-gandhi%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="#" class="pagination--pager disabled">Previous</a>
    
    
      <a href="/2020-software-fellow-posters/farhad-ramezanghorbani/" class="pagination--pager" title="Latent space representation learning as an auxiliary task for training neural network potentials
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/vh-chavez/" rel="permalink">PDFT - An accessible density embedding code
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Victor H. Chavez</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/sebastian-lee/" rel="permalink">Simple interoperability via a general representation of molecular wavefunctions
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Sebastian J. R. Lee</p>
    <p class="archive__item-excerpt" itemprop="description">Background and Motivation

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/giuseppe-barbalinardo/" rel="permalink">Efficient Anharmonic Lattice Dynamics Calculations of Thermal Transport in Crystalline and Disordered Solids using kALDo
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Giuseppe Barbalinardo</p>
    <p class="archive__item-excerpt" itemprop="description">
  kALDo is a versatile and scalable open-source software to compute phonon transport in crystalline and amorphous solids. It features real space QHGK calcul...</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/zhi-wang/" rel="permalink">Tinker GPU: GPU-Accelerated MD Simulation Software for Advanced Force Fields and Enhanced Sampling
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Zhi Wang</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction
Advanced potential energy surfaces and models are being applied to an
ever-expanding array of problems in structural biology, drug design and
ch...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/MolSSI_NSF" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/molssi" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://molssi.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
        
      
    

    <li><a href="/2020-software-fellow-posters/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2020 The Molecular Sciences Software Institute. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/2020-software-fellow-posters/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
