<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Gradients and Geometry Optimization with Multireference Wavefunctions - 2020 MolSSI Software Fellow Posters</title>
<meta name="description" content="Introduction">


  <meta name="author" content="James E. T. Smith">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="2020 MolSSI Software Fellow Posters">
<meta property="og:title" content="Gradients and Geometry Optimization with Multireference Wavefunctions">
<meta property="og:url" content="https://education.molssi.org/2020-software-fellow-posters/james-smith/">


  <meta property="og:description" content="Introduction">







  <meta property="article:published_time" content="2020-06-25T00:00:00+00:00">





  

  


<link rel="canonical" href="https://education.molssi.org/2020-software-fellow-posters/james-smith/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "The Molecular Sciences Software Institute",
      "url": "https://education.molssi.org/2020-software-fellow-posters/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/2020-software-fellow-posters/feed.xml" type="application/atom+xml" rel="alternate" title="2020 MolSSI Software Fellow Posters Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/2020-software-fellow-posters/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<link rel="stylesheet" href="https://use.typekit.net/wll4tkr.css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script src="https://unpkg.com/ngl@0.10.4/dist/ngl.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169902961-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169902961-1');
</script>


<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  <script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

  <body class="layout--poster">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/2020-software-fellow-posters/"><img src="/2020-software-fellow-posters/assets/images/avatars/molssi_avatar.png" alt=""></a>
        
        <a class="site-title" href="/2020-software-fellow-posters/">
          2020 MolSSI Software Fellow Posters
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/2020-software-fellow-posters/all_posters">Full Poster List</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/2020-software-fellow-posters/assets/images/avatars/james_smith.jpeg" alt="James E. T. Smith" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">James E. T. Smith</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Chemical Physics PhD Candidate at CU Boulder</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:james.e.smith@colorado.edu" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://jamesetsmith.github.io/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://github.com/jamesETsmith" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/james-smith-8525792b/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Gradients and Geometry Optimization with Multireference Wavefunctions">
    <meta itemprop="description" content="Introduction">
    <meta itemprop="datePublished" content="2020-06-25T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Gradients and Geometry Optimization with Multireference Wavefunctions
</h1>
          <div id="author-list" class="author__list">
            
              James E. T. Smith<sup>1</sup>,
            
              Taylor A. Barnes<sup>2</sup>,
            
              Sandeep Sharma<sup>1</sup>
            
          </div>
    
          <div id="affiliation-list" class="affiliation__list">
            
              <div>
<strong>1</strong> The University of Colorado Boulder, Boulder, CO</div>
            
              <div>
<strong>2</strong> Department of Chemistry, Virginia Tech University, Blacksburg, VA</div>
            
          </div>
       
        </header>
      

      
            <div id="mentor-name" class="mentor__list">
              <strong>MolSSI Mentor(s):</strong> Taylor A. Barnes
            </div>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Poster Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#heat-bath-configuration-interaction">Heat Bath Configuration Interaction</a></li>
  <li><a href="#nuclear-gradients-of-shci-wavefunctions">Nuclear Gradients of SHCI Wavefunctions</a></li>
  <li><a href="#implementation">Implementation</a></li>
  <li><a href="#impact-and-future-work">Impact and Future Work</a></li>
  <li><a href="#references">References</a></li>
  <li><a href="#funding-and-acknowledgements">Funding and Acknowledgements</a></li>
</ul>

            </nav>
          </aside>
        
        <h2 id="introduction">Introduction</h2>

<p>In electronic structure, “active space methods” have been very successful for systems exhibiting strong electron correlation. However, their unfavorable combinatorial scaling has driven the search for new methods that better balance computational cost and accuracy facilitating their use with larger active spaces and larger systems. Modern methods, like density matrix renormalization group (DMRG), auxiliary field quantum Monte-Carlo (AFQMC), and full configuration interaction quantum Monte-Carlo (FCIQMC),  have made important progress reducing the time and memory cost, but for certain systems the computational time is still prohibitive.</p>

<p><strong>The goal of this project is develop a computationally efficient software to treat strong electron correlation that is easy to use and interface with popular quantum chemistry packages</strong>, giving users the ability to run geometry optimizations and nonadiabatic coupling calculations with active sizes that were previously impossible.</p>

<h2 id="heat-bath-configuration-interaction">Heat Bath Configuration Interaction</h2>

<p>The general class of methods that perform a selected configuration interaction calculation followed by perturbation theory (SCI-PT) are an efficient alternative to traditional active space methods.
Semi-stochastic heat-bath configuration interaction (SHCI) is a recently developed variant of SCI+PT.
Like all configuration interaction methods, we express the wave function as a linear combination of determinants: \(\left| \Psi \right&gt; = \sum_{i} c_i \left| D_i \right&gt;\).
In SHCI, the exact wave function is approximated by a more compact expansion, where only the most important determinants are kept.
Following the variational optimization of this wave function, a perturbative energy correction from the remaining determinants is calculated semi-stochastically.</p>

\[\max_{ D_i \in \mathcal{V}} \left|H_{ai} c_i\right| &gt; \epsilon_1\]

<p><strong><em>Equation 1:</em></strong> The criteria used to select the important configurations from the exact wave function to include in the SHCI wave function.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/james_smith/hci_selection.png" alt="HCI Selection"><br>
<strong><em>Figure 1:</em></strong> A visualization of the HCI selection criteria and how it can save considerable time by never visiting weakly connected configuration, shown in green.</p>

<h2 id="nuclear-gradients-of-shci-wavefunctions">Nuclear Gradients of SHCI Wavefunctions</h2>

<p>Extensive testing of SHCI wave functions using finite difference confirms that even very approximate wave functions (those that are expanded using only a small subset of the possible determinants) have stable analytical gradients.
Similarly, when using these gradients to perform geometry optimizations, we find that even approximate wave functions produce gradients close to their exact counterparts.</p>

<!-- ![N2 CASSCF](https://education.molssi.org/2020-software-fellow-posters/assets/images/james_smith/n2_casscf_optimization.png)  -->

<p>We find that gradients of very approximate variational wavefunctions (vHCISCF) can be improved in two ways (other than the \(\epsilon_1\) parameter): first, including a perturbative correction (HCISCF); second, by using optimizing active-active (AA) orbital rotations.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/james_smith/sc2_gradient_error.png" alt="Grad"> 
<strong><em>Figure 2:</em></strong> The gradient error as a function of method for the strongly correlated scandium dimer with HCISCF(6e,18o)/cc-pVDZ. <a href="#references">[1]</a></p>

<p>In addition to gradients, we have tested geometry optimization using HCISCF wavefunctions for model and realistic systems like the Fe(pyridine(diimine)) complex shown below.
The pyridine(diimine) ligand is redox active in this species, leading to challenging electronic structure even for single point energy calculations.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/james_smith/fe_pdi_opt.png" alt="Fe PDI"> 
<strong><em>Figure 3:</em></strong> The geometry optimization of the strongly correlated iron complex containing the noninnocent pyridine(diimine) ligand using HCISCF(24e,21o)/cc-pVDZ. <a href="#references">[1]</a></p>

<h2 id="implementation">Implementation</h2>
<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/james_smith/dice_logo.png" alt="Dice Logo"></p>

<p>We want our method to help as many other researchers as possible and we know that a fast alternative to active space methods is needed in the electronic structure community.
We also know that utility alone is not enough to make our software helpful to other researchers, it has to be easy to use as well.
To achieve this, we minimize the number of steps for building, testing, and benchmarking the software. 
In order to accomplish these goals, our implementation of the SHCI algorithm, called <a href="https://sanshar.github.io/Dice/">Dice</a>, is freely available and conatains:</p>
<ul>
  <li>A mature build system using <code class="language-plaintext highlighter-rouge">Make</code>
</li>
  <li>A thorough test suite</li>
  <li>Benchmarking suite with a variety of bash scripts to expediting testing the time and memory cost on new architectures</li>
</ul>

<h2 id="impact-and-future-work">Impact and Future Work</h2>

<p>Dice is interfaced with the open source quantum chemistry package <a href="http://pyscf.org/">PySCF</a> <a href="#references">[2,3]</a>, allowing users to calculate energies and optimized geometries with active spaces that are intractable using exact methods. Users can calculate approximate energies with over 200 active space orbitals and even optimize geometries for small molecules using approximate wave functions using nearly 100 orbitals.</p>

<p>We plan to implement the calculation of nonadiabatic couplings for multireference wave functions in PySCF. This will allow users to calculate couplings with  exact or approximate wave functions and perform nonadiabatic dynamics calculations using previously intractable active spaces.</p>

<h2 id="references">References</h2>

<ol>
  <li>
    <p>J. E. T. Smith, J. Lee, S. Sharma. “Gradients of Near-Exact Wavefunctions”. In preparation (2020)</p>
  </li>
  <li>
    <p><a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/wcms.1340">Q. Sun, <em>et al</em> (2018), PySCF: the Python‐based simulations of chemistry framework. WIREs Comput. Mol. Sci., 8: e1340. doi:10.1002/wcms.1340</a></p>
  </li>
  <li>
    <p><a href="https://arxiv.org/abs/2002.12531">Q. Sun, <em>et al</em> “Recent developments in the PySCF program package”. In Review (2020).</a></p>
  </li>
</ol>

<h2 id="funding-and-acknowledgements">Funding and Acknowledgements</h2>

<p>James E. T. Smith was supported by a fellowship from The Molecular Sciences Software Institute under NSF grant OAC-1547580</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/sample-poster/nsf.png" alt="NSF Logo"><br>
<img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/molssi_avatar.png" alt="MolSSI"></p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-06-25T00:00:00+00:00">June 25, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Gradients+and+Geometry+Optimization+with+Multireference+Wavefunctions%20https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fjames-smith%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fjames-smith%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fjames-smith%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2020-software-fellow-posters/fang-liu/" class="pagination--pager" title="New Tools for Detecting MultirefPredict Character in Transition Metal Chemical Space
">Previous</a>
    
    
      <a href="/2020-software-fellow-posters/sina-mostafanejad/" class="pagination--pager" title="Reduced Density Matrix-Based Models for Strongly Correlated Electrons
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/vh-chavez/" rel="permalink">PDFT - An accessible density embedding code
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Victor H. Chavez</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/sebastian-lee/" rel="permalink">Simple interoperability via a general representation of molecular wavefunctions
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Sebastian J. R. Lee</p>
    <p class="archive__item-excerpt" itemprop="description">Background and Motivation

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/giuseppe-barbalinardo/" rel="permalink">Efficient Anharmonic Lattice Dynamics Calculations of Thermal Transport in Crystalline and Disordered Solids using kALDo
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Giuseppe Barbalinardo</p>
    <p class="archive__item-excerpt" itemprop="description">
  kALDo is a versatile and scalable open-source software to compute phonon transport in crystalline and amorphous solids. It features real space QHGK calcul...</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/zhi-wang/" rel="permalink">Tinker GPU: GPU-Accelerated MD Simulation Software for Advanced Force Fields and Enhanced Sampling
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Zhi Wang</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction
Advanced potential energy surfaces and models are being applied to an
ever-expanding array of problems in structural biology, drug design and
ch...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/MolSSI_NSF" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/molssi" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://molssi.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
        
      
    

    <li><a href="/2020-software-fellow-posters/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2020 The Molecular Sciences Software Institute. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/2020-software-fellow-posters/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
