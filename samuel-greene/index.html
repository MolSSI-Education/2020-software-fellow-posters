<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Randomized Methods for Quantum Chemistry - 2020 MolSSI Software Fellow Posters</title>
<meta name="description" content="Introduction">


  <meta name="author" content="Samuel M. Greene">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="2020 MolSSI Software Fellow Posters">
<meta property="og:title" content="Randomized Methods for Quantum Chemistry">
<meta property="og:url" content="https://education.molssi.org/2020-software-fellow-posters/samuel-greene/">


  <meta property="og:description" content="Introduction">







  <meta property="article:published_time" content="2020-06-29T00:00:00+00:00">





  

  


<link rel="canonical" href="https://education.molssi.org/2020-software-fellow-posters/samuel-greene/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "The Molecular Sciences Software Institute",
      "url": "https://education.molssi.org/2020-software-fellow-posters/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/2020-software-fellow-posters/feed.xml" type="application/atom+xml" rel="alternate" title="2020 MolSSI Software Fellow Posters Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/2020-software-fellow-posters/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<link rel="stylesheet" href="https://use.typekit.net/wll4tkr.css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script src="https://unpkg.com/ngl@0.10.4/dist/ngl.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169902961-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169902961-1');
</script>


<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  <script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

  <body class="layout--poster">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/2020-software-fellow-posters/"><img src="/2020-software-fellow-posters/assets/images/avatars/molssi_avatar.png" alt=""></a>
        
        <a class="site-title" href="/2020-software-fellow-posters/">
          2020 MolSSI Software Fellow Posters
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/2020-software-fellow-posters/all_posters">Full Poster List</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/2020-software-fellow-posters/assets/images/avatars/samuel_greene.jpg" alt="Samuel M. Greene" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Samuel M. Greene</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Ph.D. Student, Department of Chemistry, Columbia University</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:s.greene@columbia.edu" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://github.com/sgreene8" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/samuel-greene-77385933/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Randomized Methods for Quantum Chemistry">
    <meta itemprop="description" content="Introduction">
    <meta itemprop="datePublished" content="2020-06-29T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Randomized Methods for Quantum Chemistry
</h1>
          <div id="author-list" class="author__list">
            
              Samuel M. Greene<sup>1</sup>,
            
              Robert J. Webber<sup>2</sup>,
            
              Jonathan Weare<sup>2</sup>,
            
              Timothy C. Berkelbach<sup>1, 3</sup>
            
          </div>
    
          <div id="affiliation-list" class="affiliation__list">
            
              <div>
<strong>1</strong> Department of Chemistry, Columbia University, New York, NY</div>
            
              <div>
<strong>2</strong> Courant Institute of Mathematical Sciences, New York University, New York, NY</div>
            
              <div>
<strong>3</strong> Center for Computational Quantum Physics, Flatiron Institute, New York, NY</div>
            
          </div>
       
        </header>
      

      
            <div id="mentor-name" class="mentor__list">
              <strong>MolSSI Mentor(s):</strong> Benjamin Pritchard
            </div>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Poster Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#introduction">Introduction</a></li>
  <li><a href="#stochastic-sparsification">Stochastic sparsification</a></li>
  <li><a href="#estimating-the-ground-state-energy">Estimating the ground-state energy</a></li>
  <li>
<a href="#extensions-for-error-reduction">Extensions for error reduction</a>
    <ul>
      <li><a href="#initiator-approximation">Initiator approximation</a></li>
      <li><a href="#alternative-hamiltonian-matrix-factorization">Alternative Hamiltonian matrix factorization</a></li>
    </ul>
  </li>
  <li><a href="#implementation-considerations">Implementation considerations</a></li>
  <li><a href="#ongoing-work">Ongoing work</a></li>
  <li><a href="#acknowledgements">Acknowledgements</a></li>
  <li><a href="#references">References</a></li>
</ul>

            </nav>
          </aside>
        
        <h2 id="introduction">Introduction</h2>

<ul>
  <li>Strong correlation among the electrons in many molecules and materials gives rise to unique and useful properties (e.g. catalytic behavior, superconductivity).</li>
  <li>Calculating properties of strongly correlated systems is expensive, requiring the solution of linear algebra problems involving large matrices. Many conventional approximations fail for strongly correlated problems.</li>
  <li>We are developing randomized methods  able to efficiently solve linear algebra problems in quantum chemistry involving large matrices by stochastically introducing sparsity and then averaging.</li>
  <li>Our ongoing work is focused on reducing statistical error and increasing the sizes of chemical systems to which our methods can be applied.</li>
</ul>

<p>All methods described here are discussed in more detail in our <a href="https://arxiv.org/abs/2005.00654" target="_blank"> forthcoming paper</a>.</p>

<h2 id="stochastic-sparsification">Stochastic sparsification</h2>

<p>We use a 2-step process<sup>1</sup> to randomly compress a vector to a user-specified number of nonzero elements. First, we identify a set of elements that will be preserved exactly on the basis of their relative magnitudes. Then, we randomly select a subset of the remaining elements using a correlated sampling procedure. Elements are selected with probabilities proportional to their magnitude. All other elements are zeroed.</p>

\[\begin{pmatrix}
0.90 \\
-0.025 \\
0.025 \\
0.025 \\
-0.025
\end{pmatrix} \to
\begin{pmatrix}
\color{red}{0.90} \\
-\color{blue}{0.05} \\
0 \\
\color{blue}{0.05} \\
0
\end{pmatrix}\]

<p><em><strong>Figure 1</strong>: A schematic showing the stochastic compression of a vector to 3 nonzero elements. Elements designated to be preserved exactly are shown in red, while those selected during the sampling procedure are shown in blue.</em></p>

<p>Introducing zeros in this way allows for the storage of vectors in sparse format, with significantly reduced memory requirements.</p>

<h2 id="estimating-the-ground-state-energy">Estimating the ground-state energy</h2>

<p>We estimate the ground-state energy (least eigenvalue) of the full configuration interaction Hamiltonian matrix, \( \mathbf{H} \), using an iterative procedure. In each iteration, the current vector is multiplied by the matrix \( \left( \mathbf{1} - \varepsilon \mathbf{H} \right) \), where \(\varepsilon\) is a small, positive parameter. The resulting vector is then stochastically compressed. Although \( \mathbf{H} \) is sparse, the number of nonzero elements in each of its columns renders this step expensive for many chemical systems of interest. We address this by factoring \( \left( \mathbf{1} - \varepsilon \mathbf{H} \right) \) and compressing the vector obtained after multiplication by each of its factors.<sup>3, 4</sup></p>

<p>After each iteration, the energy is estimated from the resulting vector \(\mathbf{v}^{(\tau)} \) as</p>

\[E^{(\tau)} = \frac{\mathbf{v}_\text{ref}^* \mathbf{H} \mathbf{v}^{(\tau)}}{\mathbf{v}_\text{ref}^* \mathbf{v}^{(\tau)}}\]

<p>where \(\mathbf{v}^{(\tau)} \) is an approximation to the ground-state eigenvector, obtained from an approximate method. An estimate of the ground-state energy, as well as its associated standard error, are obtained by averaging over all iterations. We also report the statistical efficiency, which is inversely proportional to the square of the standard error.</p>

<h2 id="extensions-for-error-reduction">Extensions for error reduction</h2>

<h3 id="initiator-approximation">Initiator approximation</h3>

<p>The following figure shows the behavior of the energy estimates \(E^{(\tau)}\) for a small chemical system as a function of the user-specified number of nonzero elements retained in compression operations \( m \).</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/Samuel_Greene/en_trace.png" alt="Energy blowsup">
<em><strong>Figure 2</strong>: Energy estimates for the Neon atom in the aug-cc-pVDZ basis.</em></p>

<p>The standard error in the average energy increases substantially as \( m \) is decreased below a system-dependent threshold. Since the cost of these calculations (per iteration) scales with \( m \), this renders it difficult to apply this method to larger chemical systems, for which greater values of \( m \) are required.</p>

<p>We address this using the initiator approximation,<sup>5</sup> in which only the elements in the current iteration with a magnitude greater than an “initiator threshold” \( n_a \) are allowed to introduce weight in the next iteration on vector elements that were previously zero. This greatly reduces the standard error (increases the statistical efficiency).</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/Samuel_Greene/ini_trace.png" alt="Initiator trace">
<em><strong>Figure 3</strong>: Energy estimates for the Neon atom in the aug-cc-pVDZ basis obtained using the initiator approximation.</em></p>

<p>This technique is an “approximation” because it increases a bias that increases with increasing \( n_a \). Nonetheless, the associated reduction in statistical error makes this worthwhile for many chemical systems of interest.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/Samuel_Greene/ini_thresh.pdf" alt="Initiator threshold">
<em><strong>Figure 4</strong>: The behavior of the mean energy and statistical efficiency for calculations on three chemical systems as the initiator threshold is increased from 0 to 2.</em></p>

<h3 id="alternative-hamiltonian-matrix-factorization">Alternative Hamiltonian matrix factorization</h3>

<p>We developed an alternative approach to factoring the matrix \( \left( \mathbf{1} - \varepsilon \mathbf{H} \right) \) designed to further reduce the statistical error. Some of the matrix factors have fewer nonzero elements, making the associated matrix-vector multiplication operations cheaper, and their elements are cheaper to compute on the fly. We see that this alternative factorization yields consistent improvements in statistical efficiency while reducing overall execution times by as much as 17% for the three chemical systems tested.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/Samuel_Greene/newhb.pdf" alt="New factorization">
<em><strong>Figure 5</strong>: The statistical efficiencies of calculations performed using this alternative factorization scheme in relation to those performed with the existing scheme.</em></p>

<h2 id="implementation-considerations">Implementation considerations</h2>

<p>Since receiving the MolSSI fellowship, I have developed a C++ library that supports several different stochastic compression algorithms. Some subroutines are applicable to any matrix or vector, while others have features related specifically to the FCI problem. My library supports MPI parallelism, so vectors are stored in sparse format distributed among multiple MPI processes. Matrix-vector multiplication is parallelized, as is stochastic compression. I developed a protocol for performing stochastic compression that minimizes communication among processes.</p>

<h2 id="ongoing-work">Ongoing work</h2>

<ul>
  <li>Extending these methods for the estimation of excited-state energies</li>
  <li>Applying these methods to the Hubbard-Holstein model, a minimal model of superconductivity</li>
  <li>Extending the applicability of these methods to larger systems through improvements in code and stochastic sampling methodology</li>
</ul>

<h2 id="acknowledgements">Acknowledgements</h2>

<p>Samuel M. Greene was supported by a fellowship from The Molecular Sciences Software Institute under NSF grant OAC-1547580. Additional funding for this project was provided by the NSF through award DMS-1646339 and the Advanced Scientific Computing Research Program within the DOE Office of Science through award DE-SC0020427. The Flatiron Institute is a division of the Simons Foundation.</p>

<h2 id="references">References</h2>

<ol>
  <li>L.-H. Lim and J. Weare. SIAM Rev. 2017, 59, 547-587.</li>
  <li>G. H. Booth, A. J. W. Thom, and A. Alavi. J. Chem. Phys. 2009, 131, 054106.</li>
  <li>S. M. Greene, R. J. Webber, J. Weare, and T. C. Berkelbach. J. Chem. Theory Comput. 2019, 15, 4834-4850.</li>
  <li>V. A. Neufeld and A. J. W. Thom. J. Chem. Theory Comput. 2019, 15, 127-140.</li>
  <li>D. Cleland, G. H. Booth, and A. Alavi. J. Chem. Phys. 2010, 132, 041103.</li>
</ol>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-06-29T00:00:00+00:00">June 29, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Randomized+Methods+for+Quantum+Chemistry%20https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fsamuel-greene%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fsamuel-greene%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fsamuel-greene%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2020-software-fellow-posters/jennifer-clark/" class="pagination--pager" title="DESPASITO, Quickly Fit MD-Simulation Parameters using Equations of State
">Previous</a>
    
    
      <a href="/2020-software-fellow-posters/tucker-burgin/" class="pagination--pager" title="ATESA: an Automated Aimless Shooting Workflow
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/vh-chavez/" rel="permalink">PDFT - An accessible density embedding code
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Victor H. Chavez</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/sebastian-lee/" rel="permalink">Simple interoperability via a general representation of molecular wavefunctions
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Sebastian J. R. Lee</p>
    <p class="archive__item-excerpt" itemprop="description">Background and Motivation

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/giuseppe-barbalinardo/" rel="permalink">Efficient Anharmonic Lattice Dynamics Calculations of Thermal Transport in Crystalline and Disordered Solids using kALDo
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Giuseppe Barbalinardo</p>
    <p class="archive__item-excerpt" itemprop="description">
  kALDo is a versatile and scalable open-source software to compute phonon transport in crystalline and amorphous solids. It features real space QHGK calcul...</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/zhi-wang/" rel="permalink">Tinker GPU: GPU-Accelerated MD Simulation Software for Advanced Force Fields and Enhanced Sampling
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Zhi Wang</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction
Advanced potential energy surfaces and models are being applied to an
ever-expanding array of problems in structural biology, drug design and
ch...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/MolSSI_NSF" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/molssi" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://molssi.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
        
      
    

    <li><a href="/2020-software-fellow-posters/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2020 The Molecular Sciences Software Institute. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/2020-software-fellow-posters/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
