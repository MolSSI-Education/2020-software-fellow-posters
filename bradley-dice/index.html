<!DOCTYPE html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.3 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
--><html lang="en" class="no-js">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>freud: Powerful, Efficient Trajectory Analysis in Scientific Python - 2020 MolSSI Software Fellow Posters</title>
<meta name="description" content="">


  <meta name="author" content="Bradley D. Dice">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="2020 MolSSI Software Fellow Posters">
<meta property="og:title" content="freud: Powerful, Efficient Trajectory Analysis in Scientific Python">
<meta property="og:url" content="https://education.molssi.org/2020-software-fellow-posters/bradley-dice/">


  <meta property="og:description" content="">







  <meta property="article:published_time" content="2020-06-25T00:00:00+00:00">





  

  


<link rel="canonical" href="https://education.molssi.org/2020-software-fellow-posters/bradley-dice/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "The Molecular Sciences Software Institute",
      "url": "https://education.molssi.org/2020-software-fellow-posters/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/2020-software-fellow-posters/feed.xml" type="application/atom+xml" rel="alternate" title="2020 MolSSI Software Fellow Posters Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/2020-software-fellow-posters/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->
<link rel="stylesheet" href="https://use.typekit.net/wll4tkr.css">
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script src="https://unpkg.com/ngl@0.10.4/dist/ngl.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-169902961-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-169902961-1');
</script>


<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  <script>MathJax={"tex":{"inlineMath":[["$","$"],["\\(","\\)"]]},"svg":{"fontCache":"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

  <body class="layout--poster">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/2020-software-fellow-posters/"><img src="/2020-software-fellow-posters/assets/images/avatars/molssi_avatar.png" alt=""></a>
        
        <a class="site-title" href="/2020-software-fellow-posters/">
          2020 MolSSI Software Fellow Posters
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/2020-software-fellow-posters/all_posters">Full Poster List</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/2020-software-fellow-posters/assets/images/avatars/bradley_dice.jpg" alt="Bradley D. Dice" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Bradley D. Dice</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>PhD Candidate, Physics &amp; Scientific Computing at University of Michigan (Glotzer Lab)</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="mailto:bdice@umich.edu" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="https://bradleydice.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i><span class="label">Website</span></a></li>
          
        
          
            <li><a href="https://twitter.com/Bradley_Dice" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://github.com/bdice" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/bradleydice/" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="freud: Powerful, Efficient Trajectory Analysis in Scientific Python">
    <meta itemprop="description" content="            ">
    <meta itemprop="datePublished" content="2020-06-25T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">freud: Powerful, Efficient Trajectory Analysis in Scientific Python
</h1>
          <div id="author-list" class="author__list">
            
              Bradley D. Dice<sup>1</sup>,
            
              Vyas Ramasubramani<sup>2</sup>,
            
              Eric S. Harper<sup>3</sup>,
            
              Matthew P. Spellings<sup>2</sup>,
            
              Joshua A. Anderson<sup>2</sup>,
            
              Sharon C. Glotzer<sup>1, 2, 3, 4</sup>
            
          </div>
    
          <div id="affiliation-list" class="affiliation__list">
            
              <div>
<strong>1</strong> Department of Physics, University of Michigan, Ann Arbor, MI</div>
            
              <div>
<strong>2</strong> Department of Chemical Engineering, University of Michigan, Ann Arbor, MI</div>
            
              <div>
<strong>3</strong> Department of Materials Science and Engineering, University of Michigan, Ann Arbor, MI</div>
            
              <div>
<strong>4</strong> Biointerfaces Institute, University of Michigan, Ann Arbor, MI</div>
            
          </div>
       
        </header>
      

      
            <div id="mentor-name" class="mentor__list">
              <strong>MolSSI Mentor(s):</strong> Doaa Altarawy
            </div>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title">
<i class="fas fa-file-alt"></i> Poster Contents</h4></header>
              <ul class="toc__menu">
  <li><a href="#overview">Overview</a></li>
  <li><a href="#resources">Resources</a></li>
  <li>
<a href="#purpose-of-freud">Purpose of freud</a>
    <ul>
      <li><a href="#scope">Scope</a></li>
      <li><a href="#applications">Applications</a></li>
    </ul>
  </li>
  <li><a href="#core-data-structures">Core Data Structures</a></li>
  <li>
<a href="#analysis-methods">Analysis Methods</a>
    <ul>
      <li><a href="#standard-techniques">Standard Techniques</a></li>
      <li><a href="#specialized-methods">Specialized Methods</a></li>
      <li><a href="#user-defined-analysis-methods">User-defined Analysis Methods</a></li>
    </ul>
  </li>
  <li>
<a href="#open-source-community">Open-Source Community</a>
    <ul>
      <li><a href="#integrations-with-the-scientific-python-ecosystem">Integrations with the Scientific Python Ecosystem</a></li>
      <li><a href="#user-support-and-external-contributions">User Support and External Contributions</a></li>
      <li><a href="#impact-of-freud">Impact of freud</a></li>
    </ul>
  </li>
  <li><a href="#references">References</a></li>
  <li><a href="#acknowledgements">Acknowledgements</a></li>
</ul>

            </nav>
          </aside>
        
        <div>
  <a href="https://freud.readthedocs.io/en/stable/reference/citing.html"><img style="display:inline;" title="Citing freud" src="https://img.shields.io/badge/cite-freud-informational.svg"></a>
  <a href="https://pypi.org/project/freud-analysis/"><img style="display:inline;" title="PyPI" src="https://img.shields.io/pypi/v/freud-analysis.svg"></a>
  <a href="https://anaconda.org/conda-forge/freud"><img style="display:inline;" title="conda-forge" src="https://img.shields.io/conda/vn/conda-forge/freud.svg"></a>
  <a href="https://freud.readthedocs.io/en/latest/?badge=latest"><img style="display:inline;" title="ReadTheDocs" src="https://readthedocs.org/projects/freud/badge/?version=latest"></a>
  <a href="https://codecov.io/gh/glotzerlab/freud"><img style="display:inline;" title="Codecov" src="https://codecov.io/gh/glotzerlab/freud/branch/master/graph/badge.svg"></a>
  <a href="https://github.com/glotzerlab/freud"><img style="display:inline;" title="GitHub-Stars" src="https://img.shields.io/github/stars/glotzerlab/freud.svg?style=social"></a>
</div>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/bradley_dice/freud_logo.jpg" alt="freud: powerful, efficient trajectory analysis in scientific Python"></p>

<h1 id="overview">Overview</h1>

<p>The <strong>freud</strong> Python library provides a simple, flexible, powerful set of tools for analyzing trajectories obtained from molecular dynamics or Monte Carlo simulations.
High performance, parallelized C++ is used to compute standard tools such as radial distribution functions, correlation functions, order parameters, and clusters, as well as original analysis methods including potentials of mean force and torque (PMFTs) and local environment matching.
The <strong>freud</strong> library supports <a href="https://freud.readthedocs.io/en/stable/topics/datainputs.html">many input formats</a> and outputs <a href="https://numpy.org/">NumPy arrays</a>, enabling integration with the scientific Python ecosystem for many typical materials science workflows.</p>

<p>The <strong>freud</strong> project released a new major version (2.0) in November 2019. This version brought new features including:</p>
<ul>
  <li>A unified API for all analysis methods</li>
  <li>4x performance improvements (on average) across a suite of common analysis methods</li>
  <li>Flexible neighbor-finding logic that can be used to accelerate user-defined analysis methods</li>
  <li>Trajectory reader integration, supporting 25+ file formats</li>
  <li>Cross-platform support for Linux, Mac, and Windows</li>
</ul>

<h1 id="resources">Resources</h1>

<ul>
  <li>
<a href="https://freud.readthedocs.io/">Reference Documentation</a>: Examples, tutorials, topic guides, and package Python APIs.</li>
  <li>
<a href="https://freud.readthedocs.io/en/stable/gettingstarted/installation.html">Installation Guide</a>: Instructions for installing and compiling <strong>freud</strong>.</li>
  <li>
<a href="https://groups.google.com/d/forum/freud-users">freud-users Google Group</a>: Ask questions to the <strong>freud</strong> user community.</li>
  <li>
<a href="https://github.com/glotzerlab/freud">GitHub repository</a>: Download the <strong>freud</strong> source code.</li>
  <li>
<a href="https://github.com/glotzerlab/freud/issues">Issue tracker</a>: Report issues or request features.</li>
</ul>

<h1 id="purpose-of-freud">Purpose of freud</h1>

<h2 id="scope">Scope</h2>
<p>The <strong>freud</strong> library is designed for analyzing colloidal and coarse-grained simulations, where particles are frequently mesoscopic in size and lack an “atomic identity” (see Figure 1).
This makes freud suitable for applications in materials science, distinguishing the library from other packages that primary focus on biomolecular simulations such as <a href="https://www.mdanalysis.org/">MDAnalysis</a> and <a href="http://mdtraj.org/">MDTraj</a>.
Our recently published <a href="https://doi.org/10.1016/j.cpc.2020.107275">paper</a> in Computer Physics Communications describes the features and design philosophy of freud <a href="#cpc-paper">[1]</a>.
A second <a href="https://doi.org/10.25080/Majora-7ddc1dd1-004">paper</a> in the Proceedings of the 18th Python in Science Conference (SciPy 2019) describes freud’s applications in machine learning and data visualization workflows in materials science, including integrations with the <a href="https://www.ovito.org/">OVITO</a> application and other visualization frameworks <a href="#scipy-paper">[2]</a>.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/bradley_dice/freud_scales.png" alt="Figure 1: freud length scale comparison">
<em><strong>Figure 1</strong>: Common Python tools for simulation analysis at varying length scales. The freud library is designed for nanoscale systems, suchas colloidal crystals and nanoparticle assemblies. In such systems, interactions are described by coarse-grained models where particles’ atomic constituents are often irrelevant and particle anisotropy (non-spherical shape) is common, thus requiring a generalized concept of particle “types” and orientation-sensitive analyses. These features contrast the assumptions of most analysis tools designed for biomolecular simulations and materials science. Image and caption reproduced from <a href="#scipy-paper">[2]</a> under a Creative Commons Attribution License.</em></p>

<h2 id="applications">Applications</h2>

<p>The high performance, parallelized analysis methods in freud can be used to analyze systems of millions of particles <a href="#hexatic-paper">[3]</a> and perform real-time analysis for data visualization applications <a href="#scipy-paper">[2]</a>.
The <strong>freud</strong> library has been used to <a href="https://doi.org/10.1063/1.5021347">analyze kinetics of triblock Janus colloids</a>, <a href="https://doi.org/10.1063/1.5043401">quantify evaporation-induced assembly</a>, <a href="https://doi.org/10.1002/aic.16157">perform machine learning on crystal structures</a>, <a href="https://doi.org/10.1063/1.5063802">optimize pair potentials</a>, and more.
A more extensive list of publications that have used <strong>freud</strong> can be found in our recent paper <a href="#cpc-paper">[1]</a>.</p>

<h1 id="core-data-structures">Core Data Structures</h1>

<p>The core components of <strong>freud</strong> are described for users via the package documentation’s <a href="https://freud.readthedocs.io/en/stable/gettingstarted/tutorial.html">Tutorial</a>.
In short, all analyses in <strong>freud</strong> act on a “system,” which is composed of a <a href="https://freud.readthedocs.io/en/stable/gettingstarted/tutorial/periodic.html">periodic simulation box</a> and an array of particle positions.
The most common computation performed by the <strong>freud</strong> library is <a href="https://freud.readthedocs.io/en/stable/gettingstarted/tutorial/neighborfinding.html">finding particles’ neighbors</a>, which forms the core of almost all the analysis methods offered by the library.
A visual depiction of how data flows through the <strong>freud</strong> library is shown in Figure 2.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/bradley_dice/freud_data_flow.png" alt="Figure 2: freud data flow">
<em><strong>Figure 2</strong>: Here we show the flow of various types of inputs into <strong>freud</strong>. Boxes can be constructed based on a variety of inputs, all of which can also directly be provided anywhere a box object is required. Similarly, any object that can be interpreted as an array can be provided where particle positions are required. Any valid pair of box and points can be used to construct a <code class="language-plaintext highlighter-rouge">NeighborQuery</code> object, which is one of the types of systems that <strong>freud</strong> accepts. In addition to a <code class="language-plaintext highlighter-rouge">NeighborQuery</code>, <strong>freud</strong> can also interpret raw tuples of boxes and points as system objects, or use simulation frames from numerous external tools (a subset are shown in the figure). Any computation that involves finding nearest neighbors also requires a specification of neighbors, which can be a <code class="language-plaintext highlighter-rouge">NeighborList</code> or a dictionary of query arguments. The “Example of Usage” box on the right shows a typical use case of <strong>freud</strong> that combines these concepts. Reprinted from <a href="#cpc-paper">[1]</a>.</em></p>

<h1 id="analysis-methods">Analysis Methods</h1>

<h2 id="standard-techniques">Standard Techniques</h2>

<p>The <strong>freud</strong> library includes many analysis methods common to statistical mechanics and materials science, including the radial distribution function \(g(r)\), correlation functions (shown in Figure 3), and clustering algorithms.
Additionally, the <strong>freud</strong> library incorporates the <a href="http://math.lbl.gov/voro++/">voro++</a> library for fast computations of Voronoi diagrams (shown in Figure 3).
The library includes a wide range of order parameters useful for distinguishing phases and identifying crystal structures, including the Steinhardt order parameter and cubatic order parameter shown in Figure 4.
All features, including code examples and sample figures, are shown in the <a href="https://freud.readthedocs.io/en/stable/index.html">freud documentation</a>.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/bradley_dice/hexatic_2d.jpg" alt="Figure 3: Hard 2D Polygons">
<em><strong>Figure 3</strong>: The <strong>freud</strong> library is capable of computing a number of characteristics of a system of particles. Here, we demonstrate some of those features on a 2D Monte Carlo simulation of polygons that exhibits hexatic ordering <a href="#hexatic-paper">[3]</a>.</em> a) <em>Phase separation is clearly evident in this system of pentagons colored by local density ; the system is divided into denser (blue) and less dense (red) regions.</em> b) <em>Zooming into a particularly dense region shows that the hexatic ordering (left half) is generally uniform across the region. The Voronoi diagram of the system (right half) is also largely defect-free, with just a few pentagons having more or fewer than 6 nearest neighbors.</em> c) <em>The spatial correlation of the hexatic order parameter is nearly constant for a nearly perfect crystal of pentagons (orange), whereas it decays very quickly in a fluid (blue). For a comparable system of hexagons, however, we see a power-law decay (green) in the hexatic order parameter due to the presence of a hexatic phase between the solid and fluid phases.</em> d) <em>The radial distribution function for the system of pentagons shows the expected sequence of neighbor shells as a function of distance. Reprinted from <a href="#cpc-paper">[1]</a>.</em></p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/bradley_dice/order_parameters.jpg" alt="Figure 4: Order Parameters">
<em><strong>Figure 4</strong>: Various order parameters can be used to characterize the degree of ordering in a system. The per-particle order parameter values eventually converge to a uniform global value as the system becomes globally well-ordered. These plots show the evolution of two order parameters over the course of a Monte Carlo simulation of hard particles, which over time rearrange into an ordered phase under compression. Simulation snapshots are colored by the per-particle order parameter and rendered with <a href="https://fresnel.readthedocs.io/">fresnel</a>.</em> a) <em>The Steinhardt \(Q_6\) order parameter is an appropriate scalar descriptor for systems forming a BCC (cI2-W) structure. Systems of cuboctahedra in the fluid phase show a distinctly different characteristic value of the order parameter than in the solid phase.</em> b) <em>The cubatic order parameter \(K_{\Omega^4}\) is useful for characterizing ordering in these systems of octahedra. Reprinted from <a href="#cpc-paper">[1]</a>.</em></p>

<h2 id="specialized-methods">Specialized Methods</h2>

<p>Several analysis methods in <strong>freud</strong> are unique to the library and not implemented elsewhere.
Two modules with such unique features are <code class="language-plaintext highlighter-rouge">pmft</code>, which implements the <a href="https://freud.readthedocs.io/en/stable/modules/pmft.html">Potential of Mean Force and Torque method</a> shown in Figure 5, and <code class="language-plaintext highlighter-rouge">environment</code>, which contains <a href="https://freud.readthedocs.io/en/stable/modules/environment.html">several features for analyzing crystalline environments</a>.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/bradley_dice/pmft.jpg" alt="Figure 5: Potential of Mean Force and Torque">
<em><strong>Figure 5</strong>: The PMFT is related to the probability of finding particles at a given position and orientation relative to one another.</em> a) <em>The PMFT of an ordered system of hexagons <a href="#shape-allophiles-paper">[4]</a>, where the locations of the wells indicate that particles are much more likely to sit next to the edges of their neighbors than the corners. In two-dimensional systems, the full PMFT is 3-dimensional, since it also must account for the orientation of the second particle relative to the first; for clarity, in this figure we have integrated out that degree of freedom.</em> b) <em>A PMFT computed from a system of rhombicosidodecahedra shows distributions of neighboring particles in three dimensions (figure rendered using <a href="https://docs.enthought.com/mayavi/mayavi/">Mayavi</a>). There are six degrees of freedom in 3D systems, three translational and three rotational. This PMFT only shows the three translational degrees of freedom. The wells representing the deepest energy isosurfaces of the PMFT align with the largest (pentagonal) facets of the polyhedron. Reprinted from <a href="#cpc-paper">[1]</a>.</em></p>

<h2 id="user-defined-analysis-methods">User-defined Analysis Methods</h2>

<p>The core data structures for finding particle neighbors also enable user-defined analyses, where neighbor finding is handled by <strong>freud</strong> and user-defined code performs computations over the sets of neighbor bonds.
For example, the example code below (an excerpt from a corresponding <a href="https://freud.readthedocs.io/en/stable/gettingstarted/examples/examples/NetworkX-CNA.html">example in the documentation</a>) implements Common Neighbor Analysis.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
<td class="code"><pre><span class="kn">import</span> <span class="nn">freud</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1"># Use a face-centered cubic (fcc) system
</span><span class="n">box</span><span class="p">,</span> <span class="n">points</span> <span class="o">=</span> <span class="n">freud</span><span class="p">.</span><span class="n">data</span><span class="p">.</span><span class="n">UnitCell</span><span class="p">.</span><span class="n">fcc</span><span class="p">().</span><span class="n">generate_system</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">aq</span> <span class="o">=</span> <span class="n">freud</span><span class="p">.</span><span class="n">AABBQuery</span><span class="p">(</span><span class="n">box</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>
<span class="n">nl</span> <span class="o">=</span> <span class="n">aq</span><span class="p">.</span><span class="n">query</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="p">{</span><span class="s">'num_neighbors'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s">'exclude_ii'</span><span class="p">:</span> <span class="bp">True</span><span class="p">}).</span><span class="n">toNeighborList</span><span class="p">()</span>

<span class="c1"># Get all sets of common neighbors.
</span><span class="n">common_neighbors</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nl</span><span class="p">.</span><span class="n">point_indices</span><span class="p">[</span><span class="n">nl</span><span class="p">.</span><span class="n">query_point_indices</span> <span class="o">==</span> <span class="n">i</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">nl</span><span class="p">.</span><span class="n">point_indices</span><span class="p">[</span><span class="n">nl</span><span class="p">.</span><span class="n">query_point_indices</span> <span class="o">==</span> <span class="n">j</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">k</span><span class="p">:</span>
                <span class="n">common_neighbors</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">)].</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Next, we use NetworkX to build graphs of common neighbors and compute the Common Neighbor Analysis signatures.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre></td>
<td class="code"><pre><span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="n">nx</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="n">diagrams</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="n">particle_counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">Counter</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="n">neighbors</span> <span class="ow">in</span> <span class="n">common_neighbors</span><span class="p">.</span><span class="n">items</span><span class="p">():</span>
    <span class="c1"># Build up the graph of connections between the
</span>    <span class="c1"># common neighbors of a and b.
</span>    <span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="p">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">neighbors</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">(</span><span class="n">nl</span><span class="p">.</span><span class="n">point_indices</span><span class="p">[</span>
            <span class="n">nl</span><span class="p">.</span><span class="n">query_point_indices</span> <span class="o">==</span> <span class="n">i</span><span class="p">]).</span><span class="n">intersection</span><span class="p">(</span><span class="n">neighbors</span><span class="p">):</span>
            <span class="n">g</span><span class="p">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>

    <span class="c1"># Define the identifiers for a CNA diagram:
</span>    <span class="c1"># The first integer is 1 if the particles are bonded, otherwise 2
</span>    <span class="c1"># The second integer is the number of shared neighbors
</span>    <span class="c1"># The third integer is the number of bonds among shared neighbors
</span>    <span class="c1"># The fourth integer is an index, just to ensure uniqueness of diagrams
</span>    <span class="n">diagram_type</span> <span class="o">=</span> <span class="mi">2</span><span class="o">-</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span> <span class="ow">in</span> <span class="n">nl</span><span class="p">.</span><span class="n">point_indices</span><span class="p">[</span><span class="n">nl</span><span class="p">.</span><span class="n">query_point_indices</span> <span class="o">==</span> <span class="n">a</span><span class="p">])</span>
    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">diagram_type</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">neighbors</span><span class="p">),</span> <span class="n">g</span><span class="p">.</span><span class="n">number_of_edges</span><span class="p">())</span>
    <span class="c1"># If we've seen any neighborhood graphs with this signature,
</span>    <span class="c1"># we explicitly check if the two graphs are identical to
</span>    <span class="c1"># determine whether to save this one. Otherwise, we add
</span>    <span class="c1"># the new graph immediately.
</span>    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">diagrams</span><span class="p">:</span>
        <span class="n">isomorphs</span> <span class="o">=</span> <span class="p">[</span><span class="n">nx</span><span class="p">.</span><span class="n">is_isomorphic</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">diagrams</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>
        <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">isomorphs</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">isomorphs</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">diagrams</span><span class="p">[</span><span class="n">key</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">diagrams</span><span class="p">[</span><span class="n">key</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">diagrams</span><span class="p">[</span><span class="n">key</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">diagrams</span><span class="p">[</span><span class="n">key</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
    <span class="n">cna_signature</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="p">(</span><span class="n">idx</span><span class="p">,)</span>
    <span class="n">particle_counts</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">update</span><span class="p">([</span><span class="n">cna_signature</span><span class="p">])</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<p>Looking at the counts of common neighbor signatures, we see that the first particle of the fcc structure has 12 bonds with signature (1, 4, 2, 0) as we expect.</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><table class="rouge-table"><tbody><tr>
<td class="gutter gl"><pre class="lineno">1
</pre></td>
<td class="code"><pre><span class="n">particle_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></td>
</tr></tbody></table></code></pre></figure>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">Counter</span><span class="p">({(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">12</span><span class="p">,</span>
         <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">6</span><span class="p">,</span>
         <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">12</span><span class="p">,</span>
         <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="mi">24</span><span class="p">})</span></code></pre></figure>

<h1 id="open-source-community">Open-Source Community</h1>

<h2 id="integrations-with-the-scientific-python-ecosystem">Integrations with the Scientific Python Ecosystem</h2>
<p>Leveraging the NumPy library for data arrays allows <strong>freud</strong> to easily integrate with a wide variety of other packages in the scientific Python ecosystem.
Users of <strong>freud</strong> can execute analyses in a <a href="https://jupyter.org/">Jupyter notebook</a> and use the <code class="language-plaintext highlighter-rouge">plot()</code> method of any compute object to see the results immediately without having to manually set axis labels or titles.
This plotting functionality uses <a href="https://matplotlib.org/">Matplotlib</a>, and can be used with user-provided <code class="language-plaintext highlighter-rouge">Axis</code> objects for additional customization.
The use of these standard scientific Python libraries, in addition to previously mentioned integrations with MDAnalysis, MDTraj, and OVITO, ensure <strong>freud</strong> is accessible to new users without significant alteration to their existing workflows.</p>

<h2 id="user-support-and-external-contributions">User Support and External Contributions</h2>

<p>The <a href="https://groups.google.com/d/forum/freud-users">freud-users Google Group</a> is available for user support, with responses typically within 1 business day.
The <strong>freud</strong> library has had 39 code contributors, primarily from the University of Michigan, though several recent features have been developed in direct response to community requests from the Google Group or GitHub issue tracker.
Whenever possible, the <strong>freud</strong> development team encourages pull requests and/or code review from external users in response to their feature requests or bug reports, building a shared sense of ownership in the results.</p>

<h2 id="impact-of-freud">Impact of freud</h2>

<p>Though it is extremely difficult to estimate the size of any package’s user base, metrics from the documentation web pages indicate that the number of <strong>freud</strong> users has grown significantly over the last two years.
The package has been downloaded over 90,000 times <a href="https://anaconda.org/conda-forge/freud">from conda-forge</a> and the number of users visiting freud’s documentation has grown substantially, shown in Figure 6.</p>

<p><img src="https://education.molssi.org/2020-software-fellow-posters/assets/images/bradley_dice/freud_dau.jpg" alt="Figure 6: freud Documentation - Daily Active Users">
<em><strong>Figure 6</strong>: Daily active users visiting freud’s documentation in the last 1, 7, 14, or 28 days, from April 1, 2018 to June 26, 2020.</em></p>

<h1 id="references">References</h1>
<p>Figures 2, 3, 4, 5 are reprinted from <a href="#cpc-paper">[1]</a>, copyright 2020, with permission from Elsevier.</p>
<ol>
  <li>
<a name="cpc-paper"></a>V. Ramasubramani, B. D. Dice, E. S. Harper, M. P. Spellings, J. A. Anderson, and S. C. Glotzer. freud: A Software Suite for High Throughput Analysis of Particle Simulation Data. Computer Physics Communications Volume 254, September 2020, 107275. <a href="https://doi.org/10.1016/j.cpc.2020.107275">https://doi.org/10.1016/j.cpc.2020.107275</a>.</li>
  <li>
<a name="scipy-paper"></a>B. Dice, V. Ramasubramani, E. S. Harper, M. P. Spellings, J. A. Anderson, and S. C. Glotzer. Analyzing Particle Systems for Machine Learning and Data Visualization with freud. Proceedings of the 18th Python in Science Conf. (SciPy 2019), SciPy, 27-33. <a href="https://doi.org/10.25080/Majora-7ddc1dd1-004">https://doi.org/10.25080/Majora-7ddc1dd1-004</a>. See also this <a href="https://www.youtube.com/watch?v=D0LWh1BzPRQ">YouTube video of the <strong>freud</strong> talk at SciPy 2019</a>.</li>
  <li>
<a name="hexatic-paper"></a>J. A. Anderson, J. Antonaglia, J. A. Millan, M. Engel, &amp; S. C. Glotzer. Shape and Symmetry Determine Two-Dimensional Melting Transitions of Hard Regular Polygons. Physical Review X, 7(2), 021001 (2017). <a href="https://doi.org/10.1103/PhysRevX.7.021001">https://doi.org/10.1103/PhysRevX.7.021001</a>.</li>
  <li>
<a name="shape-allophiles-paper"></a> E. S. Harper, R. L. Marson, J. A. Anderson, G. van Anders, &amp; S. C. Glotzer. Shape allophiles improve entropic assembly. Soft Matter, 11(37), 7250–7256 (2015). <a href="https://doi.org/10.1039/C5SM01351H">https://doi.org/10.1039/C5SM01351H</a>.</li>
</ol>

<h1 id="acknowledgements">Acknowledgements</h1>

<p>Support for the design and development of <strong>freud</strong> has evolved over time and with programmatic research directions.
A majority of the code development including all public code releases are supported by the National Science Foundation, Division of Materials Research under a Computational and Data-Enabled Science &amp; Engineering Award # DMR 1409620 (2014-2018) and the Office of Advanced Cyberinfrastructure Award # OAC 1835612 (2018-2021).
Conceptualization and early implementations were supported in part by the DOD/ASD (R&amp;E) under Award No. N00244-09-1-0062 and also by the National Science Foundation, Integrative Graduate Education and Research Traineeship, Award # DGE 0903629 (E.S.H. and M.P.S.).
Bradley Dice acknowledges fellowship support from the National Science Foundation under OAC-1547580, S212: Impl: The Molecular Sciences Software Institute and an earlier National Science Foundation Graduate Research Fellowship Grant # DGE 1256260 (2016-2019).
Vyas Ramasubramani holds the 2019-2020 J. Robert Beyster Computational Innovation Graduate Fellowship at the University of Michigan.
Computational resources and services supported in part by Advanced Research Computing at the University of Michigan, Ann Arbor.
Any opinions, findings, and conclusions or recommendations expressed in this publication are those of the authors and do not necessarily reflect the views of the DOD/ASD (R&amp;E).</p>

        
      </section>

      <footer class="page__meta">
        
        


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-06-25T00:00:00+00:00">June 25, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=freud%3A+Powerful%2C+Efficient+Trajectory+Analysis+in+Scientific+Python%20https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fbradley-dice%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fbradley-dice%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Feducation.molssi.org%2F2020-software-fellow-posters%2Fbradley-dice%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2020-software-fellow-posters/pascal-merz/" class="pagination--pager" title="A High-Performance Hybrid Monte Carlo / Molecular Dynamics Framework For GROMACS
">Previous</a>
    
    
      <a href="/2020-software-fellow-posters/fang-liu/" class="pagination--pager" title="New Tools for Detecting MultirefPredict Character in Transition Metal Chemical Space
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/vh-chavez/" rel="permalink">PDFT - An accessible density embedding code
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Victor H. Chavez</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/sebastian-lee/" rel="permalink">Simple interoperability via a general representation of molecular wavefunctions
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Sebastian J. R. Lee</p>
    <p class="archive__item-excerpt" itemprop="description">Background and Motivation

</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/giuseppe-barbalinardo/" rel="permalink">Efficient Anharmonic Lattice Dynamics Calculations of Thermal Transport in Crystalline and Disordered Solids using kALDo
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Giuseppe Barbalinardo</p>
    <p class="archive__item-excerpt" itemprop="description">
  kALDo is a versatile and scalable open-source software to compute phonon transport in crystalline and amorphous solids. It features real space QHGK calcul...</p>
  </article>
</div>

        
          





<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/2020-software-fellow-posters/zhi-wang/" rel="permalink">Tinker GPU: GPU-Accelerated MD Simulation Software for Advanced Force Fields and Enhanced Sampling
</a>
      
    </h2>
    
    <p class="archive__item-excerpt" itemprop="author">Zhi Wang</p>
    <p class="archive__item-excerpt" itemprop="description">Introduction
Advanced potential energy surfaces and models are being applied to an
ever-expanding array of problems in structural biology, drug design and
ch...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
          <li><a href="https://twitter.com/MolSSI_NSF" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
        
      
        
          <li><a href="https://github.com/molssi" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://molssi.org/" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-link" aria-hidden="true"></i> Website</a></li>
        
      
    

    <li><a href="/2020-software-fellow-posters/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">© 2020 The Molecular Sciences Software Institute. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/2020-software-fellow-posters/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
